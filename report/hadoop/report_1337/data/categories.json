{
  "uid" : "4b4757e66a1912dae1a509f688f20b0f",
  "children" : [ {
    "name" : "Product defects",
    "children" : [ {
      "name" : "AssertionError: 执行sql异常,返回结果：\n{'result': 1, 'msg': \"Error running query: org.apache.spark.sql.AnalysisException: java.lang.Integer cannot be cast to org.apache.spark.unsafe.types.UTF8String; line 6 pos 10 Query: select extract(month from to_date('2109-07-02','yyyy-mm-dd')) current_month from emp; Parameters: []\", 'detilMsg': \"java.sql.SQLException: Error running query: org.apache.spark.sql.AnalysisException: java.lang.Integer cannot be cast to org.apache.spark.unsafe.types.UTF8String; line 6 pos 10 Query: select extract(month from to_date('2109-07-02','yyyy-mm-dd')) current_month from emp; Parameters: []\\n\\tat org.apache.commons.dbutils.AbstractQueryRunner.rethrow(AbstractQueryRunner.java:392)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:64)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:27)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.executeQuery(SQLExecutor.java:167)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.execute(SQLExecutor.java:60)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$FastClassBySpringCGLIB$$87a3a589.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:736)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)\\n\\tat org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:282)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:671)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$EnhancerBySpringCGLIB$$c3fff041.execute(<generated>)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl.exec(SQLParseServiceImpl.java:276)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$FastClassBySpringCGLIB$$b336c078.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:667)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$EnhancerBySpringCGLIB$$b4ae0e6e.exec(<generated>)\\n\\tat com.sefonsoft.sdcdw.resource.dwrun.SQLParseResource.exec(SQLParseResource.java:232)\\n\\tat sun.reflect.GeneratedMethodAccessor216.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)\\n\\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)\\n\\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)\\n\\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:661)\\n\\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:742)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.SessionContextFilter.doFilter(SessionContextFilter.java:40)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.AuthFilter.doFilter(AuthFilter.java:139)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:496)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:790)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1468)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\\n\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:745)\\n\", 'duration': 1.1, 'head': None, 'data': None, 'affectNum': -1}",
      "children" : [ {
        "name" : "test_plsql_single_function[日期时间函数_03_extract]",
        "uid" : "7d7d8c122f613062",
        "parentUid" : "ec3e6718812a7825b51e3a6fea067c7b",
        "status" : "failed",
        "time" : {
          "start" : 1609388354617,
          "stop" : 1609388356070,
          "duration" : 1453
        },
        "flaky" : false,
        "newFailed" : false,
        "parameters" : [ "{'module_name': 'SQL 单行函数使用', 'module_case_name': '日期时间函数_03_extract', 'name_id': 'dwrun_sql_429_date_function_extract', 'isInitialized': 0, 'sqltype': 'plsql', 'tb_name': 'emp', 'exec_order': ['sql'], 'exec_sql': {'sql': 'f\"select extract(month from to_date(\\'2109-07-02\\',\\'yyyy-mm-dd\\')) current_month from {tb_name};\"'}, 'expected_result': [['July']]}" ]
      } ],
      "uid" : "ec3e6718812a7825b51e3a6fea067c7b"
    }, {
      "name" : "AssertionError: 执行sql异常,返回结果：\n{'result': 1, 'msg': \"Error running query: org.apache.spark.sql.AnalysisException: Invalid number of arguments for function trunc. Expected: 2; Found: 1; line 6 pos 9 Query: select trunc(months_between(to_date('2018-10-30','yyyy-MM-dd'),to_date('2019-10-30','yyyy-MM-dd')))/2) work_year from emp where empno=2222 Parameters: []\", 'detilMsg': \"java.sql.SQLException: Error running query: org.apache.spark.sql.AnalysisException: Invalid number of arguments for function trunc. Expected: 2; Found: 1; line 6 pos 9 Query: select trunc(months_between(to_date('2018-10-30','yyyy-MM-dd'),to_date('2019-10-30','yyyy-MM-dd')))/2) work_year from emp where empno=2222 Parameters: []\\n\\tat org.apache.commons.dbutils.AbstractQueryRunner.rethrow(AbstractQueryRunner.java:392)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:64)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:27)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.executeQuery(SQLExecutor.java:167)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.execute(SQLExecutor.java:60)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$FastClassBySpringCGLIB$$87a3a589.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:736)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)\\n\\tat org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:282)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:671)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$EnhancerBySpringCGLIB$$c3fff041.execute(<generated>)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl.exec(SQLParseServiceImpl.java:276)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$FastClassBySpringCGLIB$$b336c078.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:667)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$EnhancerBySpringCGLIB$$b4ae0e6e.exec(<generated>)\\n\\tat com.sefonsoft.sdcdw.resource.dwrun.SQLParseResource.exec(SQLParseResource.java:232)\\n\\tat sun.reflect.GeneratedMethodAccessor216.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)\\n\\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)\\n\\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)\\n\\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:661)\\n\\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:742)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.SessionContextFilter.doFilter(SessionContextFilter.java:40)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.AuthFilter.doFilter(AuthFilter.java:139)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:496)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:790)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1468)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\\n\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:745)\\n\", 'duration': 0.89, 'head': None, 'data': None, 'affectNum': -1}",
      "children" : [ {
        "name" : "test_plsql_single_function[日期时间函数_04_months_between]",
        "uid" : "6e8015360f0c6b69",
        "parentUid" : "696f62faa65e37302ede4b1393318286",
        "status" : "failed",
        "time" : {
          "start" : 1609388356420,
          "stop" : 1609388357718,
          "duration" : 1298
        },
        "flaky" : false,
        "newFailed" : false,
        "parameters" : [ "{'module_name': 'SQL 单行函数使用', 'module_case_name': '日期时间函数_04_months_between', 'name_id': 'dwrun_sql_429_date_function_months_between', 'isInitialized': 0, 'sqltype': 'plsql', 'tb_name': 'emp', 'exec_order': ['sql'], 'exec_sql': {'sql': 'f\"select trunc(months_between(to_date(\\'2018-10-30\\',\\'yyyy-MM-dd\\'),to_date(\\'2019-10-30\\',\\'yyyy-MM-dd\\')))/2) work_year from {tb_name} where empno=2222\"'}, 'expected_result': [['-6']]}" ]
      } ],
      "uid" : "696f62faa65e37302ede4b1393318286"
    }, {
      "name" : "AssertionError: 执行sql异常,返回结果：\n{'result': 1, 'msg': \"Error running query: org.apache.spark.sql.AnalysisException: cannot resolve 'trunc(avg(spark_catalog.autotest_roc.emp.`sal`), CAST(1 AS STRING))' due to data type mismatch: argument 1 requires date type, however, 'avg(spark_catalog.autotest_roc.emp.`sal`)' is of decimal(11,6) type.; line 7 pos 5;\\n'Project [*]\\n+- 'Filter ('SEFONSOFT_TWO_TX.SEFONSOFT_ROW_NO_X > 0)\\n   +- 'SubqueryAlias SEFONSOFT_TWO_TX\\n      +- 'GlobalLimit 200\\n         +- 'LocalLimit 200\\n            +- 'Project [row_number() windowspecdefinition(1 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS SEFONSOFT_ROW_NO_X#626, ArrayBuffer(SEFONSOFT_ONE_TX).*]\\n               +- 'Filter (1 = 1)\\n                  +- 'SubqueryAlias SEFONSOFT_ONE_TX\\n                     +- 'Aggregate [sum(sal#633) AS sum(sal)#638, unresolvedalias(trunc(avg(sal#633), cast(1 as string)), None)]\\n                        +- Filter (cast(deptno#635 as decimal(4,0)) = cast(cast(10 as decimal(2,0)) as decimal(4,0)))\\n                           +- SubqueryAlias spark_catalog.autotest_roc.emp\\n                              +- HiveTableRelation `autotest_roc`.`emp`, org.apache.hadoop.hive.hbase.HBaseSerDe, [EMPNO#628, ENAME#629, JOB#630, MGR#631, HIREDATE#632, SAL#633, COMM#634, DEPTNO#635], Statistics(sizeInBytes=0.0 B)\\n Query: select sum(sal),trunc(avg(sal),1) from emp where deptno=10; Parameters: []\", 'detilMsg': \"java.sql.SQLException: Error running query: org.apache.spark.sql.AnalysisException: cannot resolve 'trunc(avg(spark_catalog.autotest_roc.emp.`sal`), CAST(1 AS STRING))' due to data type mismatch: argument 1 requires date type, however, 'avg(spark_catalog.autotest_roc.emp.`sal`)' is of decimal(11,6) type.; line 7 pos 5;\\n'Project [*]\\n+- 'Filter ('SEFONSOFT_TWO_TX.SEFONSOFT_ROW_NO_X > 0)\\n   +- 'SubqueryAlias SEFONSOFT_TWO_TX\\n      +- 'GlobalLimit 200\\n         +- 'LocalLimit 200\\n            +- 'Project [row_number() windowspecdefinition(1 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS SEFONSOFT_ROW_NO_X#626, ArrayBuffer(SEFONSOFT_ONE_TX).*]\\n               +- 'Filter (1 = 1)\\n                  +- 'SubqueryAlias SEFONSOFT_ONE_TX\\n                     +- 'Aggregate [sum(sal#633) AS sum(sal)#638, unresolvedalias(trunc(avg(sal#633), cast(1 as string)), None)]\\n                        +- Filter (cast(deptno#635 as decimal(4,0)) = cast(cast(10 as decimal(2,0)) as decimal(4,0)))\\n                           +- SubqueryAlias spark_catalog.autotest_roc.emp\\n                              +- HiveTableRelation `autotest_roc`.`emp`, org.apache.hadoop.hive.hbase.HBaseSerDe, [EMPNO#628, ENAME#629, JOB#630, MGR#631, HIREDATE#632, SAL#633, COMM#634, DEPTNO#635], Statistics(sizeInBytes=0.0 B)\\n Query: select sum(sal),trunc(avg(sal),1) from emp where deptno=10; Parameters: []\\n\\tat org.apache.commons.dbutils.AbstractQueryRunner.rethrow(AbstractQueryRunner.java:392)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:64)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:27)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.executeQuery(SQLExecutor.java:167)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.execute(SQLExecutor.java:60)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$FastClassBySpringCGLIB$$87a3a589.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:736)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)\\n\\tat org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:282)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:671)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$EnhancerBySpringCGLIB$$c3fff041.execute(<generated>)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl.exec(SQLParseServiceImpl.java:276)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$FastClassBySpringCGLIB$$b336c078.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:667)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$EnhancerBySpringCGLIB$$b4ae0e6e.exec(<generated>)\\n\\tat com.sefonsoft.sdcdw.resource.dwrun.SQLParseResource.exec(SQLParseResource.java:232)\\n\\tat sun.reflect.GeneratedMethodAccessor216.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)\\n\\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)\\n\\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)\\n\\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:661)\\n\\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:742)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.SessionContextFilter.doFilter(SessionContextFilter.java:40)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.AuthFilter.doFilter(AuthFilter.java:139)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:496)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:790)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1468)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\\n\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:745)\\n\", 'duration': 0.77, 'head': None, 'data': None, 'affectNum': -1}",
      "children" : [ {
        "name" : "test_plsql_single_function[数字函数_02_trunc]",
        "uid" : "69a39d35c296858b",
        "parentUid" : "ae0ad2a05f5b0c914cc909f4bd2b150a",
        "status" : "failed",
        "time" : {
          "start" : 1609388375741,
          "stop" : 1609388376764,
          "duration" : 1023
        },
        "flaky" : false,
        "newFailed" : false,
        "parameters" : [ "{'module_name': 'SQL 单行函数使用', 'module_case_name': '数字函数_02_trunc', 'name_id': 'dwrun_sql_430_number_function_02_trunc', 'isInitialized': 0, 'sqltype': 'plsql', 'tb_name': 'emp', 'exec_order': ['sql'], 'exec_sql': {'sql': 'f\"select sum(sal),trunc(avg(sal),1) from {tb_name} where deptno=10;\"'}, 'expected_result': [['8751.1', '2917']]}" ]
      } ],
      "uid" : "ae0ad2a05f5b0c914cc909f4bd2b150a"
    }, {
      "name" : "AssertionError: 查询数据与默认查询数据不一致，请检查\nexpected_result: \n[['1', '0', '2']]\ndata_dict: \n[['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2'], ['1', '0', '2']]",
      "children" : [ {
        "name" : "test_plsql_single_function[数字函数_03_mod]",
        "uid" : "74d5a01829f7306a",
        "parentUid" : "3a15db21a5f54d534f6594ecd1b37945",
        "status" : "failed",
        "time" : {
          "start" : 1609388376949,
          "stop" : 1609388393944,
          "duration" : 16995
        },
        "flaky" : false,
        "newFailed" : false,
        "parameters" : [ "{'module_name': 'SQL 单行函数使用', 'module_case_name': '数字函数_03_mod', 'name_id': 'dwrun_sql_430_number_function_03_mod', 'isInitialized': 0, 'sqltype': 'plsql', 'tb_name': 'emp', 'exec_order': ['sql'], 'exec_sql': {'sql': 'f\"select mod(10,3),mod(3,3),mod(2,3) from {tb_name};\"'}, 'expected_result': [['1', '0', '2']]}" ]
      } ],
      "uid" : "3a15db21a5f54d534f6594ecd1b37945"
    }, {
      "name" : "AssertionError: 执行sql异常,返回结果：\n{'result': 1, 'msg': \"Error running query: org.apache.spark.sql.AnalysisException: Undefined function: 'to_char'. This function is neither a registered temporary function nor a permanent function registered in the database 'autotest_roc'.; line 6 pos 18 Query: select ename,to_char(sal,'L99999.99') salary from emp where deptno=20; Parameters: []\", 'detilMsg': \"java.sql.SQLException: Error running query: org.apache.spark.sql.AnalysisException: Undefined function: 'to_char'. This function is neither a registered temporary function nor a permanent function registered in the database 'autotest_roc'.; line 6 pos 18 Query: select ename,to_char(sal,'L99999.99') salary from emp where deptno=20; Parameters: []\\n\\tat org.apache.commons.dbutils.AbstractQueryRunner.rethrow(AbstractQueryRunner.java:392)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:64)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:27)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.executeQuery(SQLExecutor.java:167)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.execute(SQLExecutor.java:60)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$FastClassBySpringCGLIB$$87a3a589.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:736)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)\\n\\tat org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:282)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:671)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$EnhancerBySpringCGLIB$$c3fff041.execute(<generated>)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl.exec(SQLParseServiceImpl.java:276)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$FastClassBySpringCGLIB$$b336c078.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:667)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$EnhancerBySpringCGLIB$$b4ae0e6e.exec(<generated>)\\n\\tat com.sefonsoft.sdcdw.resource.dwrun.SQLParseResource.exec(SQLParseResource.java:232)\\n\\tat sun.reflect.GeneratedMethodAccessor216.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)\\n\\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)\\n\\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)\\n\\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:661)\\n\\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:742)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.SessionContextFilter.doFilter(SessionContextFilter.java:40)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.AuthFilter.doFilter(AuthFilter.java:139)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:496)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:790)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1468)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\\n\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:745)\\n\", 'duration': 0.92, 'head': None, 'data': None, 'affectNum': -1}",
      "children" : [ {
        "name" : "test_plsql_single_function[转换函数_01_to_char]",
        "uid" : "2a72128d7d270bed",
        "parentUid" : "536aaa196040c2ba9df8704a0988a45b",
        "status" : "failed",
        "time" : {
          "start" : 1609388394192,
          "stop" : 1609388395318,
          "duration" : 1126
        },
        "flaky" : false,
        "newFailed" : false,
        "parameters" : [ "{'module_name': 'SQL 单行函数使用', 'module_case_name': '转换函数_01_to_char', 'name_id': 'dwrun_sql_431_transform_function_01_to_char', 'isInitialized': 0, 'sqltype': 'plsql', 'tb_name': 'emp', 'exec_order': ['sql'], 'exec_sql': {'sql': 'f\"select ename,to_char(sal,\\'L99999.99\\') salary from {tb_name} where deptno=20;\"'}, 'expected_result': [['ALLEN', '1991-02-20'], ['JONES2', '2000-04-02'], ['MARTIN', '2001-09-28'], ['KING', '1999-11-17'], ['JAMES', '1995-12-03'], ['MILLER', '1982-01-23']]}" ]
      } ],
      "uid" : "536aaa196040c2ba9df8704a0988a45b"
    }, {
      "name" : "AssertionError: 执行sql异常,返回结果：\n{'result': 1, 'msg': \"Error running query: org.apache.spark.sql.AnalysisException: Undefined function: 'to_number'. This function is neither a registered temporary function nor a permanent function registered in the database 'autotest_roc'.; line 8 pos 15 Query: select ename,sal from emp where sal>to_number('$3000.00','$99999.99'); Parameters: []\", 'detilMsg': \"java.sql.SQLException: Error running query: org.apache.spark.sql.AnalysisException: Undefined function: 'to_number'. This function is neither a registered temporary function nor a permanent function registered in the database 'autotest_roc'.; line 8 pos 15 Query: select ename,sal from emp where sal>to_number('$3000.00','$99999.99'); Parameters: []\\n\\tat org.apache.commons.dbutils.AbstractQueryRunner.rethrow(AbstractQueryRunner.java:392)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:64)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.StatTimeOutQueryRunner.query(StatTimeOutQueryRunner.java:27)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.executeQuery(SQLExecutor.java:167)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor.execute(SQLExecutor.java:60)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$FastClassBySpringCGLIB$$87a3a589.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:736)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:157)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor$1.proceedWithInvocation(TransactionInterceptor.java:99)\\n\\tat org.springframework.transaction.interceptor.TransactionAspectSupport.invokeWithinTransaction(TransactionAspectSupport.java:282)\\n\\tat org.springframework.transaction.interceptor.TransactionInterceptor.invoke(TransactionInterceptor.java:96)\\n\\tat org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:179)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:671)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLExecutor$$EnhancerBySpringCGLIB$$c3fff041.execute(<generated>)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl.exec(SQLParseServiceImpl.java:276)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$FastClassBySpringCGLIB$$b336c078.invoke(<generated>)\\n\\tat org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:204)\\n\\tat org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:667)\\n\\tat com.sefonsoft.sdcdw.service.dwrun.impl.SQLParseServiceImpl$$EnhancerBySpringCGLIB$$b4ae0e6e.exec(<generated>)\\n\\tat com.sefonsoft.sdcdw.resource.dwrun.SQLParseResource.exec(SQLParseResource.java:232)\\n\\tat sun.reflect.GeneratedMethodAccessor216.invoke(Unknown Source)\\n\\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\\n\\tat java.lang.reflect.Method.invoke(Method.java:498)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:205)\\n\\tat org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:133)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:97)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:827)\\n\\tat org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:738)\\n\\tat org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:85)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:967)\\n\\tat org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:901)\\n\\tat org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:970)\\n\\tat org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:872)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:661)\\n\\tat org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:846)\\n\\tat javax.servlet.http.HttpServlet.service(HttpServlet.java:742)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:52)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.SessionContextFilter.doFilter(SessionContextFilter.java:40)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat com.sefonsoft.sdcdw.util.filter.AuthFilter.doFilter(AuthFilter.java:139)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HttpPutFormContentFilter.doFilterInternal(HttpPutFormContentFilter.java:109)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:81)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:197)\\n\\tat org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)\\n\\tat org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)\\n\\tat org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:198)\\n\\tat org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)\\n\\tat org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:496)\\n\\tat org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:140)\\n\\tat org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:81)\\n\\tat org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:87)\\n\\tat org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)\\n\\tat org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:803)\\n\\tat org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)\\n\\tat org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:790)\\n\\tat org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1468)\\n\\tat org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)\\n\\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\\n\\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\\n\\tat org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)\\n\\tat java.lang.Thread.run(Thread.java:745)\\n\", 'duration': 0.54, 'head': None, 'data': None, 'affectNum': -1}",
      "children" : [ {
        "name" : "test_plsql_single_function[转换函数_03_to_number]",
        "uid" : "38261a1747dbdb21",
        "parentUid" : "5349ff1ed0a2669742a80b8e983fc157",
        "status" : "failed",
        "time" : {
          "start" : 1609388412495,
          "stop" : 1609388413275,
          "duration" : 780
        },
        "flaky" : false,
        "newFailed" : false,
        "parameters" : [ "{'module_name': 'SQL 单行函数使用', 'module_case_name': '转换函数_03_to_number', 'name_id': 'dwrun_sql_431_transform_function_03_to_number', 'isInitialized': 0, 'sqltype': 'plsql', 'tb_name': 'emp', 'exec_order': ['sql'], 'exec_sql': {'sql': 'f\"select ename,sal from {tb_name} where sal>to_number(\\'$3000.00\\',\\'$99999.99\\');\"'}, 'expected_result': [['KING', '5000.6']]}" ]
      } ],
      "uid" : "5349ff1ed0a2669742a80b8e983fc157"
    } ],
    "uid" : "8fb3a91ba5aaf9de24cc8a92edc82b5d"
  } ],
  "name" : "categories"
}